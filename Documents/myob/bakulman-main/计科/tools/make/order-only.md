éå¸¸å¥½çš„é—®é¢˜ï¼ğŸ¯  
`order-only ä¾èµ–ï¼ˆorder-only prerequisiteï¼‰` æ˜¯ GNU Make ä¸­ä¸€ä¸ª**éå¸¸æœ‰ç”¨ä½†å¸¸è¢«å¿½ç•¥**çš„æœºåˆ¶ã€‚  
å®ƒè§£å†³äº†ä¸€ä¸ªç‰¹å®šé—®é¢˜ï¼š**â€œç›®æ ‡éœ€è¦åœ¨æŸäº›æ–‡ä»¶å­˜åœ¨ä¹‹åæ‰èƒ½ç”Ÿæˆï¼Œä½†è¿™äº›æ–‡ä»¶çš„ä¿®æ”¹ä¸åº”è¯¥è§¦å‘é‡æ–°æ„å»ºã€‚â€**

---

## ğŸ§  ä¸€å¥è¯æ€»ç»“

> **â€œorder-only ä¾èµ–â€ = å¿…é¡»å­˜åœ¨ï¼Œä½†ä¸å½±å“é‡æ–°æ„å»ºçš„ä¾èµ–ã€‚**

è¯­æ³•ï¼š

```makefile
target: normal_deps | order_only_deps
```

ç«–çº¿ `|` å·¦è¾¹æ˜¯æ™®é€šä¾èµ–ï¼Œå³è¾¹æ˜¯ **order-only ä¾èµ–**ã€‚

---

## ğŸ” ä¸¾ä¸ªç›´è§‚ä¾‹å­

å‡è®¾ä½ è¦åœ¨ `build/` ç›®å½•ä¸‹ç”Ÿæˆä¸€äº› `.o` æ–‡ä»¶ï¼š

```makefile
build/%.o: %.c
	@echo "Compiling $< -> $@"
	@mkdir -p $(dir $@)
	@gcc -c $< -o $@
```

### é—®é¢˜æ¥äº†ï¼š

å¦‚æœ `build/` ç›®å½•ä¸å­˜åœ¨ï¼Œ`mkdir -p` å°±è¦åˆ›å»ºå®ƒã€‚  
äºæ˜¯æˆ‘ä»¬å¯èƒ½è¿™æ ·å†™ï¼š

```makefile
build/%.o: %.c build/
	@gcc -c $< -o $@
```

é‚£çœ‹ä¼¼æ²¡é—®é¢˜ï¼Œä½†â€”â€”

### âš ï¸ å¦‚æœ `build/` ç›®å½•çš„**æ—¶é—´æˆ³å˜åŒ–äº†**ï¼ˆæ¯”å¦‚ä½ åˆ äº†åˆæ–°å»ºï¼‰ï¼Œ

Make ä¼šä»¥ä¸ºä¾èµ–å˜åŒ–äº†ï¼Œäºæ˜¯ï¼š

> ğŸ’¥ å®ƒä¼šé‡æ–°ç¼–è¯‘æ‰€æœ‰ `.o` æ–‡ä»¶ï¼

è¿™é€šå¸¸ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„è¡Œä¸ºã€‚

---

## âœ… æ­£ç¡®å†™æ³•ï¼šä½¿ç”¨ order-only ä¾èµ–

```makefile
build/%.o: %.c | build/
	@gcc -c $< -o $@
```

æ„æ€æ˜¯ï¼š

> â€œè¦ç”Ÿæˆ `build/%.o` æ—¶ï¼Œ`build/` ç›®å½•å¿…é¡»å­˜åœ¨ï¼ˆå¦‚æœæ²¡æœ‰å°±å»ºï¼‰ï¼Œ  
> ä½† `build/` ç›®å½•çš„æ›´æ–°æ—¶é—´**ä¸ä¼šè§¦å‘é‡æ–°ç¼–è¯‘**ã€‚â€

å®Œç¾ âœ…

---

## ğŸ“˜ å†çœ‹æ›´æ¸…æ™°çš„ä¾‹å­

```makefile
objects = build/main.o build/util.o

all: $(objects)

build/%.o: %.c | build/
	@echo "Compiling $<"
	@gcc -c $< -o $@

build/:
	mkdir -p build/
```

### è¿‡ç¨‹è¯´æ˜ï¼š

1. ç¬¬ä¸€æ¬¡è¿è¡Œï¼š  
    `build/` ä¸å­˜åœ¨ â†’ å…ˆæ‰§è¡Œ `mkdir -p build/`  
    ç„¶åç¼–è¯‘ `.o` æ–‡ä»¶ã€‚
    
2. ç¬¬äºŒæ¬¡è¿è¡Œï¼ˆå³ä½¿ `build/` æ—¶é—´æˆ³æ›´æ–°ï¼‰ï¼š  
    åªè¦ `.c` æ²¡å˜ï¼Œ`make` ä¸ä¼šé‡ç¼–è¯‘ã€‚
    

---

## ğŸ” ä»€ä¹ˆæ—¶å€™ç”¨ order-only ä¾èµ–ï¼Ÿ

|åœºæ™¯|ç¤ºä¾‹|
|---|---|
|éœ€è¦ç¡®ä¿ç›®å½•å­˜åœ¨|`|
|éœ€è¦ç¡®ä¿ç”Ÿæˆè·¯å¾„å­˜åœ¨|`|
|æŸäº›å¤–éƒ¨å·¥å…·ã€é…ç½®æ–‡ä»¶å¿…é¡»å­˜åœ¨ä½†ä¸ä¼šå½±å“è¾“å‡º|`|
|ä¸´æ—¶æ–‡ä»¶å¤¹ã€æ—¥å¿—ç›®å½•ã€ç¼“å­˜ç›®å½•ç­‰|`|

---

## âš™ï¸ è¡Œä¸ºå¯¹æ¯”è¡¨

|ç±»å‹|è¯­æ³•|å½“ä¾èµ–æ›´æ–°æ—¶æ˜¯å¦è§¦å‘é‡å»º|ç”¨é€”|
|---|---|---|---|
|æ™®é€šä¾èµ–|`:`|âœ… ä¼šè§¦å‘|æ–‡ä»¶å†…å®¹ç›¸å…³|
|order-only ä¾èµ–|`|`|âŒ ä¸è§¦å‘|

---

## ğŸ§  åŸç†ï¼ˆMake çš„æ¨ç†è¿‡ç¨‹ï¼‰

å½“æ‰§è¡Œï¼š

```makefile
target: A | B
```

Make çš„åˆ¤æ–­é¡ºåºï¼š

1. æ£€æŸ¥ A å’Œ target çš„æ—¶é—´æˆ³ï¼šA æ¯” target æ–° â†’ éœ€è¦é‡å»ºï¼›
    
2. æ£€æŸ¥ B æ˜¯å¦å­˜åœ¨ï¼šå¦‚æœä¸å­˜åœ¨ â†’ å…ˆåˆ›å»ºï¼›
    
3. ä½† B çš„æ—¶é—´æˆ³æ›´æ–° **ä¸ä¼š**è§¦å‘ target é‡å»ºã€‚
    

---

## ğŸ§© å°æµ‹è¯•ä¾‹å­

è¯•è¯•è¿™ä¸ªï¼š

```makefile
.PHONY: all clean

all: result.txt

result.txt: input.txt | temp/
	@echo "Generating result.txt..."
	@echo "done" > result.txt

temp/:
	mkdir -p temp/

clean:
	rm -rf temp/ result.txt
```

è¿è¡Œæ­¥éª¤ï¼š

1. `make` â†’ ä¼šåˆ›å»º `temp/`ã€`result.txt`
    
2. å†è¿è¡Œ `make` â†’ ä»€ä¹ˆéƒ½ä¸åš
    
3. æ‰‹åŠ¨æ‰§è¡Œ `touch temp/`ï¼ˆæ›´æ–°æ—¶é—´æˆ³ï¼‰
    
4. å†è¿è¡Œ `make`  
    âœ… ä¸ä¼šé‡å»º `result.txt`ï¼
    

---

## ğŸš€ æ€»ç»“

|ç‰¹æ€§|æ™®é€šä¾èµ–|Order-only ä¾èµ–|
|---|---|---|
|å¿…é¡»å­˜åœ¨|âœ…|âœ…|
|æ”¹åŠ¨è§¦å‘é‡å»º|âœ…|âŒ|
|å…¸å‹ç”¨é€”|ç¼–è¯‘ã€é“¾æ¥æ–‡ä»¶|ç›®å½•ã€å·¥å…·ç¯å¢ƒ|
|è¯­æ³•|`target: deps`|`target: deps|

---

ç®€çŸ­è®°å¿†æ³• ğŸ§ ï¼š

> **æ™®é€šä¾èµ–çœ‹å†…å®¹ï¼Œorder-only ä¾èµ–çœ‹å­˜åœ¨ã€‚**

---

æ˜¯å¦å¸Œæœ›æˆ‘ç»™ä½ å±•ç¤ºä¸€ä¸ªâ€œå®Œæ•´çš„ C++ é¡¹ç›® Makefileâ€ï¼Œé‡Œé¢åŒæ—¶ç”¨åˆ°äº† `wildcard`ã€`patsubst`ã€å’Œ `order-only`ï¼Ÿ  
é‚£ä¼šéå¸¸ç›´è§‚åœ°çœ‹åˆ°ä¸‰è€…å¦‚ä½•é…åˆã€‚