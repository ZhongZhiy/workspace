> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [www.cnblogs.com](https://www.cnblogs.com/helloylh/p/17250948.html)


差分介绍
----

差分是一种常见的算法，用于**快速修改数组中某一段区间的值**。

差分的思想就是预处理出数组的差分数组，**然后修改区间时，只需要修改两个位置的值**，即可快速完成区间修改。最后再通过差分数组求出原数组。 差分数组 $d_i$ 表示原数组中相邻两个元素之间的差值，即 $$d_i=a_i-a_{i-1}$$，其中 $a_i$ 表示原数组中第 $i$ 个元素的值。则对于区间 $[l,r]$ 的加上 $k$ 的操作，可以表示为： $$d_l=d_l+k,\quad d_{r+1}=d_{r+1}-k$$ 这样就完成了区间加 $k$ 的操作。最后只需要用差分数组求出原数组即可。 $$a_i=\sum_{j=1}^{i} d_j$$

差分应用
----

### 区间加

以区间加为例，设 $a_i$ 表示原数组中第 $i$ 个元素的值，$d_i$ 表示差分数组中第 $i$ 个元素的值，则对于区间 $[l,r]$ 的加上 $k$ 的操作，可以表示为： $$d_l=d_l+k,\quad d_{r+1}=d_{r+1}-k$$ 最后只需要用差分数组求出原数组即可： $$a_i=\sum_{j=1}^{i} d_j$$ 以下是区间加的代码实现：

```cpp
vector<int> a; // 原数组
vector<int> d(a.size(), 0); // 差分数组// 区间加 k
int l = 2, r = 5, k = 3;d[l] += k;d[r+1] -= k;// 求出原数组
for (int i = 1; i < a.size(); i++) {    
	d[i] += d[i-1];
	}
```

### 区间求和

另一种常见的操作是区间求和。设 $a_i$ 表示原数组中第 $i$ 个元素的值，$d_i$ 表示差分数组中第 $i$ 个元素的值，则对于区间 $[l,r]$ 的求和操作，可以表示为： $$\sum_{i=l}^{r} a_i = \sum_{i=l}^{r} (\sum_{j=1}^{i} d_j) = \sum_{j=1}^{r} d_j - \sum_{j=1}^{l-1} d_j$$ 这样就能用差分数组快速求出区间和了。 

